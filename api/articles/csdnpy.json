{"title":"Python+GitHub实现CSDN的自动签到抽奖+网易云签到，并用钉钉机器人通知","slug":"csdnpy","date":"2021-02-27T13:29:08.000Z","updated":"2022-07-22T13:52:53.121Z","comments":true,"path":"api/articles/csdnpy.json","excerpt":null,"covers":["https://cloud.mr90.top/hexo/4/csdnpyrr.webp","https://cloud.mr90.top/hexo/4/csdn231892391.webp","https://cloud.mr90.top/hexo/4/csdn7891231289h.webp","https://cloud.mr90.top/hexo/4/wyyy7123192.webp"],"content":"<div class=\"note success icon flat\"><p>使用python+GitHub实现CSDN的自动签到，并用钉钉通知加入自动抽奖</p></div>\n\n<h2 id=\"仓库地址\"><a href=\"#仓库地址\" class=\"headerlink\" title=\"仓库地址\"></a>仓库地址</h2><ul>\n<li>【<a href=\"https://github.com/Rr210/qiandao\">地址</a>】</li>\n<li>下面代码为<strong>部分代码</strong>，去仓库获取完整代码</li>\n<li>加入网易云音乐签到</li>\n</ul>\n<h2 id=\"自动签到代码\"><a href=\"#自动签到代码\" class=\"headerlink\" title=\"自动签到代码\"></a>自动签到代码</h2><details green><summary> <p>查看代码</p> </summary>\n              <div class='content'>\n              <figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> os  <span class=\"comment\">#加入环境变量</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    COOKIE = os.environ[<span class=\"string\">&quot;COOKIE&quot;</span>]  <span class=\"comment\"># 点击签到后在控制台从heard里面找到COOKIE</span></span><br><span class=\"line\">    USERNAME = os.environ[<span class=\"string\">&quot;USERNAME&quot;</span>]  <span class=\"comment\"># 这里是’CSDN‘的用户名，链接后面的</span></span><br><span class=\"line\">    DDSECRET = os.environ[<span class=\"string\">&quot;DDSECRET&quot;</span>]  <span class=\"comment\"># 钉钉通知加签</span></span><br><span class=\"line\">    DDPOSTURL = os.environ[<span class=\"string\">&quot;DDPOSTURL&quot;</span>]  <span class=\"comment\"># 钉钉通知机器人的链接地址</span></span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept&#x27;</span>: <span class=\"string\">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-encoding&#x27;</span>: <span class=\"string\">&#x27;gzip, deflate, br&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-language&#x27;</span>: <span class=\"string\">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-length&#x27;</span>: <span class=\"string\">&#x27;246&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-type&#x27;</span>: <span class=\"string\">&#x27;application/json;charset=UTF-8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;cookie&#x27;</span>: COOKIE,</span><br><span class=\"line\">    <span class=\"string\">&#x27;origin&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;referer&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net/&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua&#x27;</span>: <span class=\"string\">&#x27;&quot;Chromium&quot;;v=&quot;88&quot;, &quot;Google Chrome&quot;;v=&quot;88&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class=\"string\">&#x27;?0&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-dest&#x27;</span>: <span class=\"string\">&#x27;empty&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-mode&#x27;</span>: <span class=\"string\">&#x27;cors&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-site&#x27;</span>: <span class=\"string\">&#x27;same-site&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user-agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;ip&#x27;</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;platform&#x27;</span>: <span class=\"string\">&#x27;pc-my&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;product&#x27;</span>: <span class=\"string\">&#x27;pc&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user_agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;username&#x27;</span>: USERNAME,</span><br><span class=\"line\">    <span class=\"string\">&#x27;uuid&#x27;</span>: <span class=\"string\">&#x27;10_10212595300-1608558661367-119405&#x27;</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">r = requests.post(<span class=\"string\">&quot;https://me.csdn.net/api/LuckyDraw_v2/signIn&quot;</span>,headers=headers,data=data).content.decode(<span class=\"string\">&quot;unicode_escape&quot;</span>)</span><br><span class=\"line\">print(r)  <span class=\"comment\"># 输出结果</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\">timedata = json.loads(r)</span><br><span class=\"line\"><span class=\"comment\"># 将json转化为数组形式</span></span><br><span class=\"line\">print(timedata)</span><br><span class=\"line\">isSign = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;isSigned&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># print(isSign) #返回签到逻辑值</span></span><br><span class=\"line\">t = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;msg&#x27;</span>]</span><br><span class=\"line\">print(t)  <span class=\"comment\"># 返回签到结果</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 钉钉通知模块</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> hmac</span><br><span class=\"line\"><span class=\"keyword\">import</span> hashlib</span><br><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib.parse</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests, json</span><br><span class=\"line\"></span><br><span class=\"line\">timestamp = <span class=\"built_in\">str</span>(<span class=\"built_in\">round</span>(time.time() * <span class=\"number\">1000</span>))</span><br><span class=\"line\">secret = DDSECRET</span><br><span class=\"line\">secret_enc = secret.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">string_to_sign = <span class=\"string\">&#x27;&#123;&#125;\\n&#123;&#125;&#x27;</span>.<span class=\"built_in\">format</span>(timestamp, secret)</span><br><span class=\"line\">string_to_sign_enc = string_to_sign.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">hmac_code = hmac.new(secret_enc, string_to_sign_enc, digestmod=hashlib.sha256).digest()</span><br><span class=\"line\">sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))</span><br><span class=\"line\"><span class=\"comment\"># 导入依赖库</span></span><br><span class=\"line\">headers = &#123;<span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span>&#125;  <span class=\"comment\"># 定义数据类型</span></span><br><span class=\"line\"><span class=\"comment\"># 截至到&amp;timestamp之前</span></span><br><span class=\"line\">webhook = DDPOSTURL + timestamp + <span class=\"string\">&quot;&amp;sign=&quot;</span> + sign</span><br><span class=\"line\"><span class=\"comment\"># 定义要发送的数据</span></span><br><span class=\"line\"><span class=\"comment\"># &quot;at&quot;: &#123;&quot;atMobiles&quot;: &quot;[&#x27;&quot;+ mobile + &quot;&#x27;]&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> isSign:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">    <span class=\"comment\">#定义内容</span></span><br><span class=\"line\">    <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">     <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">         <span class=\"string\">&quot;title&quot;</span>:<span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">         <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&gt;CSDN 签到已成功\\n - 签到详情:&quot;</span> + t + <span class=\"string\">&quot;\\n⭐项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)   <span class=\"comment\">#发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">        <span class=\"comment\"># 定义内容</span></span><br><span class=\"line\">        <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;title&quot;</span>: <span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;签到失败&quot;</span> + <span class=\"string\">&#x27;\\n 签到详情&#x27;</span> + t + <span class=\"string\">&quot;\\n项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)  <span class=\"comment\"># 发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br></pre></td></tr></table></figure>\n              </div>\n            </details>\n\n<h2 id=\"py加入自动抽奖操作\"><a href=\"#py加入自动抽奖操作\" class=\"headerlink\" title=\"py加入自动抽奖操作\"></a>py加入自动抽奖操作</h2><details green><summary> <p>查看部分代码</p> </summary>\n              <div class='content'>\n              <figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> os  <span class=\"comment\">#加入环境变量</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    COOKIE = os.environ[<span class=\"string\">&quot;COOKIE&quot;</span>]  <span class=\"comment\"># 点击签到后在控制台从heard里面找到COOKIE</span></span><br><span class=\"line\">    USERNAME = os.environ[<span class=\"string\">&quot;USERNAME&quot;</span>]  <span class=\"comment\"># 这里是’CSDN‘的用户名，链接后面的</span></span><br><span class=\"line\">    DDSECRET = os.environ[<span class=\"string\">&quot;DDSECRET&quot;</span>]  <span class=\"comment\"># 钉钉通知加签</span></span><br><span class=\"line\">    DDPOSTURL = os.environ[<span class=\"string\">&quot;DDPOSTURL&quot;</span>]  <span class=\"comment\"># 钉钉通知机器人的链接地址</span></span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept&#x27;</span>: <span class=\"string\">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-encoding&#x27;</span>: <span class=\"string\">&#x27;gzip, deflate, br&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-language&#x27;</span>: <span class=\"string\">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-length&#x27;</span>: <span class=\"string\">&#x27;246&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-type&#x27;</span>: <span class=\"string\">&#x27;application/json;charset=UTF-8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;cookie&#x27;</span>: COOKIE,</span><br><span class=\"line\">    <span class=\"string\">&#x27;origin&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;referer&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net/&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua&#x27;</span>: <span class=\"string\">&#x27;&quot;Chromium&quot;;v=&quot;88&quot;, &quot;Google Chrome&quot;;v=&quot;88&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class=\"string\">&#x27;?0&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-dest&#x27;</span>: <span class=\"string\">&#x27;empty&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-mode&#x27;</span>: <span class=\"string\">&#x27;cors&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-site&#x27;</span>: <span class=\"string\">&#x27;same-site&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user-agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;ip&#x27;</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;platform&#x27;</span>: <span class=\"string\">&#x27;pc-my&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;product&#x27;</span>: <span class=\"string\">&#x27;pc&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user_agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;username&#x27;</span>: USERNAME,</span><br><span class=\"line\">    <span class=\"string\">&#x27;uuid&#x27;</span>: <span class=\"string\">&#x27;10_10212595300-1608558661367-119405&#x27;</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">r = requests.post(<span class=\"string\">&quot;https://me.csdn.net/api/LuckyDraw_v2/signIn&quot;</span>,headers=headers,data=data).content.decode(<span class=\"string\">&quot;unicode_escape&quot;</span>)</span><br><span class=\"line\">print(r)  <span class=\"comment\"># 输出结果</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\">timedata = json.loads(r)</span><br><span class=\"line\"><span class=\"comment\"># 将json转化为数组形式</span></span><br><span class=\"line\">print(timedata)</span><br><span class=\"line\">message = timedata[<span class=\"string\">&#x27;message&#x27;</span>]  <span class=\"comment\"># 返回签到的结果</span></span><br><span class=\"line\">isSign = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;isSigned&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># print(isSign) #返回签到逻辑值</span></span><br><span class=\"line\">t = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;msg&#x27;</span>]</span><br><span class=\"line\">print(t)  <span class=\"comment\"># 返回签到结果</span></span><br><span class=\"line\"><span class=\"comment\"># 返回签到天数，如果到了5天执行csdnlucky.py</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 钉钉通知模块</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> hmac</span><br><span class=\"line\"><span class=\"keyword\">import</span> hashlib</span><br><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib.parse</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests, json</span><br><span class=\"line\"></span><br><span class=\"line\">timestamp = <span class=\"built_in\">str</span>(<span class=\"built_in\">round</span>(time.time() * <span class=\"number\">1000</span>))</span><br><span class=\"line\">secret = DDSECRET</span><br><span class=\"line\">secret_enc = secret.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">string_to_sign = <span class=\"string\">&#x27;&#123;&#125;\\n&#123;&#125;&#x27;</span>.<span class=\"built_in\">format</span>(timestamp, secret)</span><br><span class=\"line\">string_to_sign_enc = string_to_sign.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">hmac_code = hmac.new(secret_enc, string_to_sign_enc, digestmod=hashlib.sha256).digest()</span><br><span class=\"line\">sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))</span><br><span class=\"line\"><span class=\"comment\"># 导入依赖库</span></span><br><span class=\"line\">headers = &#123;<span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span>&#125;  <span class=\"comment\"># 定义数据类型</span></span><br><span class=\"line\"><span class=\"comment\"># 截至到&amp;timestamp之前</span></span><br><span class=\"line\">webhook = DDPOSTURL + timestamp + <span class=\"string\">&quot;&amp;sign=&quot;</span> + sign</span><br><span class=\"line\"><span class=\"comment\"># 定义要发送的数据</span></span><br><span class=\"line\"><span class=\"comment\"># &quot;at&quot;: &#123;&quot;atMobiles&quot;: &quot;[&#x27;&quot;+ mobile + &quot;&#x27;]&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> message == <span class=\"string\">&#x27;成功&#x27;</span>:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">    <span class=\"comment\">#定义内容</span></span><br><span class=\"line\">    <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">     <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">         <span class=\"string\">&quot;title&quot;</span>:<span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">         <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&gt;CSDN 签到已成功\\n - 签到详情:&quot;</span> + t + <span class=\"string\">&quot;\\n------------⭐项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)   <span class=\"comment\">#发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">        <span class=\"comment\"># 定义内容</span></span><br><span class=\"line\">        <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;title&quot;</span>: <span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&gt;CSDN 签到失败\\n - 签到详情:&quot;</span>+ timedata + <span class=\"string\">&quot;\\n项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)  <span class=\"comment\"># 发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n              </div>\n            </details>\n\n<h2 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h2><ol>\n<li>将以上代码中<code>headers</code>和<code>data</code>替换成你自己的</li>\n<li>点击这里【<a href=\"https://i.csdn.net/#/user-center/draw\">签到地址</a>】,打开浏览器调式工具<code>console</code>，<code>F12</code>或者<code>ctrl+shift+i</code>,点击<code>network</code>后点击签到控制台会生成新的文件，点击后获得此时的<code>header</code>和<code>data</code>，<code>ctrl+c</code>复制下来</li>\n<li>转换成字典形式，转换方法【<a href=\"https://blog.csdn.net/weixin_44146025/article/details/113249043?spm=1001.2014.3001.5501\">查看方法</a>】，当然嫌麻烦可以手动修改成字典形式</li>\n</ol>\n<h2 id=\"Github配置\"><a href=\"#Github配置\" class=\"headerlink\" title=\"Github配置\"></a>Github配置</h2><ol>\n<li>将你的COOKIE和USERNAME 保存替换成以上样式，记得保存好COOKIE，将COOKIE使用环境变量放到GitHub仓库的secrets里面，如图所示</li>\n<li>修改代码第15行，第31行，第56行，第65行  将自己的信息修改<details green><summary> <p>查看图例</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/csdnpyrr.webp\"></p>\n              </div>\n            </details></li>\n<li>各个参数介绍</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Secrets</th>\n<th align=\"center\">参数介绍</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">COOKIE</td>\n<td align=\"center\">这个时签到csdn所需的COOKIE，识别用户身份必须获得</td>\n</tr>\n<tr>\n<td align=\"center\">USERNAME</td>\n<td align=\"center\">你的CSDN的用户名</td>\n</tr>\n<tr>\n<td align=\"center\">DDPOSTURL</td>\n<td align=\"center\">钉钉群机器人的webhook地址，参考钉钉<a href=\"https://developers.dingtalk.com/document/app/custom-robot-access\">官方文档</a></td>\n</tr>\n<tr>\n<td align=\"center\">DDSECRET</td>\n<td align=\"center\">设置钉钉机器人时的加签密钥</td>\n</tr>\n<tr>\n<td align=\"center\">LUCKYCOOLKIE</td>\n<td align=\"center\">执行抽奖时所需的COOKIR，获取方法与签到的cookie相同</td>\n</tr>\n<tr>\n<td align=\"center\">WYYCOOKIE</td>\n<td align=\"center\">获取方法相同</td>\n</tr>\n<tr>\n<td align=\"center\">WYYCSRFTOKEN</td>\n<td align=\"center\">在控制台获取 <code>csrf_token</code> 的值</td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>设置完成后可以手动执行或者点击<code>star</code>⭐</li>\n<li>如图已设置成功<details green><summary> <p>查看结果</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/csdn231892391.webp\"></p>\n              </div>\n            </details></li>\n<li>通知成功<details green><summary> <p>查看结果</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/csdn7891231289h.webp\"></p>\n              </div>\n            </details>\n\n</li>\n</ol>\n<h2 id=\"网易云音乐签到\"><a href=\"#网易云音乐签到\" class=\"headerlink\" title=\"网易云音乐签到\"></a>网易云音乐签到</h2><ul>\n<li>获取cookie与以上方法一致</li>\n</ul>\n<details green><summary> <p>查看图例</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/wyyy7123192.webp\"></p>\n              </div>\n            </details>\n<h2 id=\"设置定时\"><a href=\"#设置定时\" class=\"headerlink\" title=\"设置定时\"></a>设置定时</h2><ol>\n<li>将<code>.github</code>文件下的<code>workflows</code>中的<code>csdn.yml</code>中的<code>corn</code>的属性值修改</li>\n<li>注意时差mg比我们地区快8个小时</li>\n</ol>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li>【<a href=\"https://blog.csdn.net/a12355556\">参考的文章</a>】</li>\n</ul>\n<blockquote>\n<p>业余大佬们勿喷</p>\n</blockquote>\n","more":"<div class=\"note success icon flat\"><p>使用python+GitHub实现CSDN的自动签到，并用钉钉通知加入自动抽奖</p></div>\n\n<h2 id=\"仓库地址\"><a href=\"#仓库地址\" class=\"headerlink\" title=\"仓库地址\"></a>仓库地址</h2><ul>\n<li>【<a href=\"https://github.com/Rr210/qiandao\">地址</a>】</li>\n<li>下面代码为<strong>部分代码</strong>，去仓库获取完整代码</li>\n<li>加入网易云音乐签到</li>\n</ul>\n<h2 id=\"自动签到代码\"><a href=\"#自动签到代码\" class=\"headerlink\" title=\"自动签到代码\"></a>自动签到代码</h2><details green><summary> <p>查看代码</p> </summary>\n              <div class='content'>\n              <figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> os  <span class=\"comment\">#加入环境变量</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    COOKIE = os.environ[<span class=\"string\">&quot;COOKIE&quot;</span>]  <span class=\"comment\"># 点击签到后在控制台从heard里面找到COOKIE</span></span><br><span class=\"line\">    USERNAME = os.environ[<span class=\"string\">&quot;USERNAME&quot;</span>]  <span class=\"comment\"># 这里是’CSDN‘的用户名，链接后面的</span></span><br><span class=\"line\">    DDSECRET = os.environ[<span class=\"string\">&quot;DDSECRET&quot;</span>]  <span class=\"comment\"># 钉钉通知加签</span></span><br><span class=\"line\">    DDPOSTURL = os.environ[<span class=\"string\">&quot;DDPOSTURL&quot;</span>]  <span class=\"comment\"># 钉钉通知机器人的链接地址</span></span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept&#x27;</span>: <span class=\"string\">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-encoding&#x27;</span>: <span class=\"string\">&#x27;gzip, deflate, br&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-language&#x27;</span>: <span class=\"string\">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-length&#x27;</span>: <span class=\"string\">&#x27;246&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-type&#x27;</span>: <span class=\"string\">&#x27;application/json;charset=UTF-8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;cookie&#x27;</span>: COOKIE,</span><br><span class=\"line\">    <span class=\"string\">&#x27;origin&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;referer&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net/&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua&#x27;</span>: <span class=\"string\">&#x27;&quot;Chromium&quot;;v=&quot;88&quot;, &quot;Google Chrome&quot;;v=&quot;88&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class=\"string\">&#x27;?0&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-dest&#x27;</span>: <span class=\"string\">&#x27;empty&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-mode&#x27;</span>: <span class=\"string\">&#x27;cors&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-site&#x27;</span>: <span class=\"string\">&#x27;same-site&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user-agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;ip&#x27;</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;platform&#x27;</span>: <span class=\"string\">&#x27;pc-my&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;product&#x27;</span>: <span class=\"string\">&#x27;pc&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user_agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;username&#x27;</span>: USERNAME,</span><br><span class=\"line\">    <span class=\"string\">&#x27;uuid&#x27;</span>: <span class=\"string\">&#x27;10_10212595300-1608558661367-119405&#x27;</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">r = requests.post(<span class=\"string\">&quot;https://me.csdn.net/api/LuckyDraw_v2/signIn&quot;</span>,headers=headers,data=data).content.decode(<span class=\"string\">&quot;unicode_escape&quot;</span>)</span><br><span class=\"line\">print(r)  <span class=\"comment\"># 输出结果</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\">timedata = json.loads(r)</span><br><span class=\"line\"><span class=\"comment\"># 将json转化为数组形式</span></span><br><span class=\"line\">print(timedata)</span><br><span class=\"line\">isSign = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;isSigned&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># print(isSign) #返回签到逻辑值</span></span><br><span class=\"line\">t = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;msg&#x27;</span>]</span><br><span class=\"line\">print(t)  <span class=\"comment\"># 返回签到结果</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 钉钉通知模块</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> hmac</span><br><span class=\"line\"><span class=\"keyword\">import</span> hashlib</span><br><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib.parse</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests, json</span><br><span class=\"line\"></span><br><span class=\"line\">timestamp = <span class=\"built_in\">str</span>(<span class=\"built_in\">round</span>(time.time() * <span class=\"number\">1000</span>))</span><br><span class=\"line\">secret = DDSECRET</span><br><span class=\"line\">secret_enc = secret.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">string_to_sign = <span class=\"string\">&#x27;&#123;&#125;\\n&#123;&#125;&#x27;</span>.<span class=\"built_in\">format</span>(timestamp, secret)</span><br><span class=\"line\">string_to_sign_enc = string_to_sign.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">hmac_code = hmac.new(secret_enc, string_to_sign_enc, digestmod=hashlib.sha256).digest()</span><br><span class=\"line\">sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))</span><br><span class=\"line\"><span class=\"comment\"># 导入依赖库</span></span><br><span class=\"line\">headers = &#123;<span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span>&#125;  <span class=\"comment\"># 定义数据类型</span></span><br><span class=\"line\"><span class=\"comment\"># 截至到&amp;timestamp之前</span></span><br><span class=\"line\">webhook = DDPOSTURL + timestamp + <span class=\"string\">&quot;&amp;sign=&quot;</span> + sign</span><br><span class=\"line\"><span class=\"comment\"># 定义要发送的数据</span></span><br><span class=\"line\"><span class=\"comment\"># &quot;at&quot;: &#123;&quot;atMobiles&quot;: &quot;[&#x27;&quot;+ mobile + &quot;&#x27;]&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> isSign:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">    <span class=\"comment\">#定义内容</span></span><br><span class=\"line\">    <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">     <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">         <span class=\"string\">&quot;title&quot;</span>:<span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">         <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&gt;CSDN 签到已成功\\n - 签到详情:&quot;</span> + t + <span class=\"string\">&quot;\\n⭐项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)   <span class=\"comment\">#发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">        <span class=\"comment\"># 定义内容</span></span><br><span class=\"line\">        <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;title&quot;</span>: <span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;签到失败&quot;</span> + <span class=\"string\">&#x27;\\n 签到详情&#x27;</span> + t + <span class=\"string\">&quot;\\n项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)  <span class=\"comment\"># 发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br></pre></td></tr></table></figure>\n              </div>\n            </details>\n\n<h2 id=\"py加入自动抽奖操作\"><a href=\"#py加入自动抽奖操作\" class=\"headerlink\" title=\"py加入自动抽奖操作\"></a>py加入自动抽奖操作</h2><details green><summary> <p>查看部分代码</p> </summary>\n              <div class='content'>\n              <figure class=\"highlight py\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> requests</span><br><span class=\"line\"><span class=\"keyword\">import</span> os  <span class=\"comment\">#加入环境变量</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    COOKIE = os.environ[<span class=\"string\">&quot;COOKIE&quot;</span>]  <span class=\"comment\"># 点击签到后在控制台从heard里面找到COOKIE</span></span><br><span class=\"line\">    USERNAME = os.environ[<span class=\"string\">&quot;USERNAME&quot;</span>]  <span class=\"comment\"># 这里是’CSDN‘的用户名，链接后面的</span></span><br><span class=\"line\">    DDSECRET = os.environ[<span class=\"string\">&quot;DDSECRET&quot;</span>]  <span class=\"comment\"># 钉钉通知加签</span></span><br><span class=\"line\">    DDPOSTURL = os.environ[<span class=\"string\">&quot;DDPOSTURL&quot;</span>]  <span class=\"comment\"># 钉钉通知机器人的链接地址</span></span><br><span class=\"line\"></span><br><span class=\"line\">headers = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept&#x27;</span>: <span class=\"string\">&#x27;application/json, text/plain, */*&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-encoding&#x27;</span>: <span class=\"string\">&#x27;gzip, deflate, br&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;accept-language&#x27;</span>: <span class=\"string\">&#x27;zh-CN,zh;q=0.9,en;q=0.8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-length&#x27;</span>: <span class=\"string\">&#x27;246&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;content-type&#x27;</span>: <span class=\"string\">&#x27;application/json;charset=UTF-8&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;cookie&#x27;</span>: COOKIE,</span><br><span class=\"line\">    <span class=\"string\">&#x27;origin&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;referer&#x27;</span>: <span class=\"string\">&#x27;https://i.csdn.net/&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua&#x27;</span>: <span class=\"string\">&#x27;&quot;Chromium&quot;;v=&quot;88&quot;, &quot;Google Chrome&quot;;v=&quot;88&quot;, &quot;;Not A Brand&quot;;v=&quot;99&quot;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-ch-ua-mobile&#x27;</span>: <span class=\"string\">&#x27;?0&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-dest&#x27;</span>: <span class=\"string\">&#x27;empty&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-mode&#x27;</span>: <span class=\"string\">&#x27;cors&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;sec-fetch-site&#x27;</span>: <span class=\"string\">&#x27;same-site&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user-agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">data = &#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;ip&#x27;</span>: <span class=\"string\">&#x27;&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;platform&#x27;</span>: <span class=\"string\">&#x27;pc-my&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;product&#x27;</span>: <span class=\"string\">&#x27;pc&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;user_agent&#x27;</span>: <span class=\"string\">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.150 Safari/537.36&#x27;</span>,</span><br><span class=\"line\">    <span class=\"string\">&#x27;username&#x27;</span>: USERNAME,</span><br><span class=\"line\">    <span class=\"string\">&#x27;uuid&#x27;</span>: <span class=\"string\">&#x27;10_10212595300-1608558661367-119405&#x27;</span>,</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">r = requests.post(<span class=\"string\">&quot;https://me.csdn.net/api/LuckyDraw_v2/signIn&quot;</span>,headers=headers,data=data).content.decode(<span class=\"string\">&quot;unicode_escape&quot;</span>)</span><br><span class=\"line\">print(r)  <span class=\"comment\"># 输出结果</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> json</span><br><span class=\"line\">timedata = json.loads(r)</span><br><span class=\"line\"><span class=\"comment\"># 将json转化为数组形式</span></span><br><span class=\"line\">print(timedata)</span><br><span class=\"line\">message = timedata[<span class=\"string\">&#x27;message&#x27;</span>]  <span class=\"comment\"># 返回签到的结果</span></span><br><span class=\"line\">isSign = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;isSigned&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># print(isSign) #返回签到逻辑值</span></span><br><span class=\"line\">t = timedata[<span class=\"string\">&#x27;data&#x27;</span>][<span class=\"string\">&#x27;msg&#x27;</span>]</span><br><span class=\"line\">print(t)  <span class=\"comment\"># 返回签到结果</span></span><br><span class=\"line\"><span class=\"comment\"># 返回签到天数，如果到了5天执行csdnlucky.py</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 钉钉通知模块</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"><span class=\"keyword\">import</span> hmac</span><br><span class=\"line\"><span class=\"keyword\">import</span> hashlib</span><br><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"><span class=\"keyword\">import</span> urllib.parse</span><br><span class=\"line\"><span class=\"keyword\">import</span> requests, json</span><br><span class=\"line\"></span><br><span class=\"line\">timestamp = <span class=\"built_in\">str</span>(<span class=\"built_in\">round</span>(time.time() * <span class=\"number\">1000</span>))</span><br><span class=\"line\">secret = DDSECRET</span><br><span class=\"line\">secret_enc = secret.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">string_to_sign = <span class=\"string\">&#x27;&#123;&#125;\\n&#123;&#125;&#x27;</span>.<span class=\"built_in\">format</span>(timestamp, secret)</span><br><span class=\"line\">string_to_sign_enc = string_to_sign.encode(<span class=\"string\">&#x27;utf-8&#x27;</span>)</span><br><span class=\"line\">hmac_code = hmac.new(secret_enc, string_to_sign_enc, digestmod=hashlib.sha256).digest()</span><br><span class=\"line\">sign = urllib.parse.quote_plus(base64.b64encode(hmac_code))</span><br><span class=\"line\"><span class=\"comment\"># 导入依赖库</span></span><br><span class=\"line\">headers = &#123;<span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span>&#125;  <span class=\"comment\"># 定义数据类型</span></span><br><span class=\"line\"><span class=\"comment\"># 截至到&amp;timestamp之前</span></span><br><span class=\"line\">webhook = DDPOSTURL + timestamp + <span class=\"string\">&quot;&amp;sign=&quot;</span> + sign</span><br><span class=\"line\"><span class=\"comment\"># 定义要发送的数据</span></span><br><span class=\"line\"><span class=\"comment\"># &quot;at&quot;: &#123;&quot;atMobiles&quot;: &quot;[&#x27;&quot;+ mobile + &quot;&#x27;]&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> message == <span class=\"string\">&#x27;成功&#x27;</span>:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">    <span class=\"comment\">#定义内容</span></span><br><span class=\"line\">    <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">     <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">         <span class=\"string\">&quot;title&quot;</span>:<span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">         <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&gt;CSDN 签到已成功\\n - 签到详情:&quot;</span> + t + <span class=\"string\">&quot;\\n------------⭐项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">     &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)   <span class=\"comment\">#发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br><span class=\"line\"><span class=\"keyword\">else</span>:</span><br><span class=\"line\">    data = &#123;</span><br><span class=\"line\">        <span class=\"comment\"># 定义内容</span></span><br><span class=\"line\">        <span class=\"string\">&quot;msgtype&quot;</span>: <span class=\"string\">&quot;markdown&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;markdown&quot;</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;title&quot;</span>: <span class=\"string\">&quot;CSDN签到通知&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;text&quot;</span>: <span class=\"string\">&quot;&gt;CSDN 签到失败\\n - 签到详情:&quot;</span>+ timedata + <span class=\"string\">&quot;\\n项目地址：[https://github.com/Rr210/qiandao](https://github.com/Rr210/qiandao)&quot;</span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    res = requests.post(webhook, data=json.dumps(data), headers=headers)  <span class=\"comment\"># 发送post请求</span></span><br><span class=\"line\">    print(res.text)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n              </div>\n            </details>\n\n<h2 id=\"使用方法\"><a href=\"#使用方法\" class=\"headerlink\" title=\"使用方法\"></a>使用方法</h2><ol>\n<li>将以上代码中<code>headers</code>和<code>data</code>替换成你自己的</li>\n<li>点击这里【<a href=\"https://i.csdn.net/#/user-center/draw\">签到地址</a>】,打开浏览器调式工具<code>console</code>，<code>F12</code>或者<code>ctrl+shift+i</code>,点击<code>network</code>后点击签到控制台会生成新的文件，点击后获得此时的<code>header</code>和<code>data</code>，<code>ctrl+c</code>复制下来</li>\n<li>转换成字典形式，转换方法【<a href=\"https://blog.csdn.net/weixin_44146025/article/details/113249043?spm=1001.2014.3001.5501\">查看方法</a>】，当然嫌麻烦可以手动修改成字典形式</li>\n</ol>\n<h2 id=\"Github配置\"><a href=\"#Github配置\" class=\"headerlink\" title=\"Github配置\"></a>Github配置</h2><ol>\n<li>将你的COOKIE和USERNAME 保存替换成以上样式，记得保存好COOKIE，将COOKIE使用环境变量放到GitHub仓库的secrets里面，如图所示</li>\n<li>修改代码第15行，第31行，第56行，第65行  将自己的信息修改<details green><summary> <p>查看图例</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/csdnpyrr.webp\"></p>\n              </div>\n            </details></li>\n<li>各个参数介绍</li>\n</ol>\n<table>\n<thead>\n<tr>\n<th align=\"center\">Secrets</th>\n<th align=\"center\">参数介绍</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">COOKIE</td>\n<td align=\"center\">这个时签到csdn所需的COOKIE，识别用户身份必须获得</td>\n</tr>\n<tr>\n<td align=\"center\">USERNAME</td>\n<td align=\"center\">你的CSDN的用户名</td>\n</tr>\n<tr>\n<td align=\"center\">DDPOSTURL</td>\n<td align=\"center\">钉钉群机器人的webhook地址，参考钉钉<a href=\"https://developers.dingtalk.com/document/app/custom-robot-access\">官方文档</a></td>\n</tr>\n<tr>\n<td align=\"center\">DDSECRET</td>\n<td align=\"center\">设置钉钉机器人时的加签密钥</td>\n</tr>\n<tr>\n<td align=\"center\">LUCKYCOOLKIE</td>\n<td align=\"center\">执行抽奖时所需的COOKIR，获取方法与签到的cookie相同</td>\n</tr>\n<tr>\n<td align=\"center\">WYYCOOKIE</td>\n<td align=\"center\">获取方法相同</td>\n</tr>\n<tr>\n<td align=\"center\">WYYCSRFTOKEN</td>\n<td align=\"center\">在控制台获取 <code>csrf_token</code> 的值</td>\n</tr>\n</tbody></table>\n<ol start=\"3\">\n<li>设置完成后可以手动执行或者点击<code>star</code>⭐</li>\n<li>如图已设置成功<details green><summary> <p>查看结果</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/csdn231892391.webp\"></p>\n              </div>\n            </details></li>\n<li>通知成功<details green><summary> <p>查看结果</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/csdn7891231289h.webp\"></p>\n              </div>\n            </details>\n\n</li>\n</ol>\n<h2 id=\"网易云音乐签到\"><a href=\"#网易云音乐签到\" class=\"headerlink\" title=\"网易云音乐签到\"></a>网易云音乐签到</h2><ul>\n<li>获取cookie与以上方法一致</li>\n</ul>\n<details green><summary> <p>查看图例</p> </summary>\n              <div class='content'>\n              <p><img src=\"https://cloud.mr90.top/hexo/4/wyyy7123192.webp\"></p>\n              </div>\n            </details>\n<h2 id=\"设置定时\"><a href=\"#设置定时\" class=\"headerlink\" title=\"设置定时\"></a>设置定时</h2><ol>\n<li>将<code>.github</code>文件下的<code>workflows</code>中的<code>csdn.yml</code>中的<code>corn</code>的属性值修改</li>\n<li>注意时差mg比我们地区快8个小时</li>\n</ol>\n<h2 id=\"参考\"><a href=\"#参考\" class=\"headerlink\" title=\"参考\"></a>参考</h2><ul>\n<li>【<a href=\"https://blog.csdn.net/a12355556\">参考的文章</a>】</li>\n</ul>\n<blockquote>\n<p>业余大佬们勿喷</p>\n</blockquote>\n","categories":[{"name":"技术·教程","path":"api/categories/技术·教程.json"}],"tags":[]}