{"title":"自制作api图片 简单的步骤","slug":"apibuild","date":"2020-11-10T16:09:00.000Z","updated":"2022-07-24T14:53:13.275Z","comments":true,"path":"api/articles/apibuild.json","excerpt":null,"covers":null,"content":"<blockquote>\n<p>原作者：<a href=\"https://blog.csdn.net/qq_43640009/article/details/107945584\">爱吃猫的鱼</a></p>\n</blockquote>\n<h2 id=\"1-准备工作\"><a href=\"#1-准备工作\" class=\"headerlink\" title=\"1.准备工作\"></a>1.准备工作</h2><ul>\n<li>准备域名(有一个即可)</li>\n<li>服务器 学生机即可</li>\n<li>可上传图片CDN的服务器<code>推荐:又拍云</code></li>\n</ul>\n<h2 id=\"2-图片上传\"><a href=\"#2-图片上传\" class=\"headerlink\" title=\"2.图片上传\"></a>2.图片上传</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将自己喜欢的图片上传到CDN服务器</span><br></pre></td></tr></table></figure>\n<ul>\n<li>我这里准备了几个高清的图片</li>\n<li>下载地址：【<a href=\"https://grr.lanzous.com/iZVkIi9r9kd\">4k超清动漫壁纸</a>】</li>\n</ul>\n<h2 id=\"3-编写代码\"><a href=\"#3-编写代码\" class=\"headerlink\" title=\"3.编写代码\"></a>3.编写代码</h2><ul>\n<li>准备两个文件 img.txt 和random.php 文件</li>\n<li>写入一下代码，上传到服务器</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;* img.txt 文件里面编写从又拍云获取的路径 要求所有图片的路径 一行一个*&#x2F;</span><br><span class=\"line\">&#x2F;* random.php 文件中的代码如下 复制粘贴即可 *&#x2F;</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">&#x2F;&#x2F;存有美图链接的文件名img.txt</span><br><span class=\"line\">$filename &#x3D; &quot;img.txt&quot;;</span><br><span class=\"line\">if(!file_exists($filename))&#123;</span><br><span class=\"line\">    die(&#39;文件不存在&#39;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#x2F;&#x2F;从文本获取链接</span><br><span class=\"line\">$pics &#x3D; [];</span><br><span class=\"line\">$fs &#x3D; fopen($filename, &quot;r&quot;);</span><br><span class=\"line\">while(!feof($fs))&#123;</span><br><span class=\"line\">    $line&#x3D;trim(fgets($fs));</span><br><span class=\"line\">    if($line!&#x3D;&#39;&#39;)&#123;</span><br><span class=\"line\">        array_push($pics, $line);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\">&#x2F;&#x2F;从数组随机获取链接</span><br><span class=\"line\">$pic &#x3D; $pics[array_rand($pics)]; </span><br><span class=\"line\">&#x2F;&#x2F;返回指定格式</span><br><span class=\"line\">$type&#x3D;$_GET[&#39;type&#39;];</span><br><span class=\"line\">switch($type)&#123;</span><br><span class=\"line\">&#x2F;&#x2F;JSON返回</span><br><span class=\"line\">case &#39;json&#39;:</span><br><span class=\"line\">    header(&#39;Content-type:text&#x2F;json&#39;);</span><br><span class=\"line\">    die(json_encode([&#39;pic&#39;&#x3D;&gt;$pic]));</span><br><span class=\"line\">default:</span><br><span class=\"line\">    die(header(&quot;Location: $pic&quot;));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>将两个文件上传到服务器的域名文件下即可</p>\n</blockquote>\n<h2 id=\"4-访问random-php域名\"><a href=\"#4-访问random-php域名\" class=\"headerlink\" title=\"4.访问random.php域名\"></a>4.访问random.php域名</h2><blockquote>\n<p>https://你的域名/(子文件夹)/random.php<br>文件夹和文件名称可以自定</p>\n</blockquote>\n","more":"<blockquote>\n<p>原作者：<a href=\"https://blog.csdn.net/qq_43640009/article/details/107945584\">爱吃猫的鱼</a></p>\n</blockquote>\n<h2 id=\"1-准备工作\"><a href=\"#1-准备工作\" class=\"headerlink\" title=\"1.准备工作\"></a>1.准备工作</h2><ul>\n<li>准备域名(有一个即可)</li>\n<li>服务器 学生机即可</li>\n<li>可上传图片CDN的服务器<code>推荐:又拍云</code></li>\n</ul>\n<h2 id=\"2-图片上传\"><a href=\"#2-图片上传\" class=\"headerlink\" title=\"2.图片上传\"></a>2.图片上传</h2><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">将自己喜欢的图片上传到CDN服务器</span><br></pre></td></tr></table></figure>\n<ul>\n<li>我这里准备了几个高清的图片</li>\n<li>下载地址：【<a href=\"https://grr.lanzous.com/iZVkIi9r9kd\">4k超清动漫壁纸</a>】</li>\n</ul>\n<h2 id=\"3-编写代码\"><a href=\"#3-编写代码\" class=\"headerlink\" title=\"3.编写代码\"></a>3.编写代码</h2><ul>\n<li>准备两个文件 img.txt 和random.php 文件</li>\n<li>写入一下代码，上传到服务器</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#x2F;* img.txt 文件里面编写从又拍云获取的路径 要求所有图片的路径 一行一个*&#x2F;</span><br><span class=\"line\">&#x2F;* random.php 文件中的代码如下 复制粘贴即可 *&#x2F;</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\">&#x2F;&#x2F;存有美图链接的文件名img.txt</span><br><span class=\"line\">$filename &#x3D; &quot;img.txt&quot;;</span><br><span class=\"line\">if(!file_exists($filename))&#123;</span><br><span class=\"line\">    die(&#39;文件不存在&#39;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">&#x2F;&#x2F;从文本获取链接</span><br><span class=\"line\">$pics &#x3D; [];</span><br><span class=\"line\">$fs &#x3D; fopen($filename, &quot;r&quot;);</span><br><span class=\"line\">while(!feof($fs))&#123;</span><br><span class=\"line\">    $line&#x3D;trim(fgets($fs));</span><br><span class=\"line\">    if($line!&#x3D;&#39;&#39;)&#123;</span><br><span class=\"line\">        array_push($pics, $line);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125; </span><br><span class=\"line\">&#x2F;&#x2F;从数组随机获取链接</span><br><span class=\"line\">$pic &#x3D; $pics[array_rand($pics)]; </span><br><span class=\"line\">&#x2F;&#x2F;返回指定格式</span><br><span class=\"line\">$type&#x3D;$_GET[&#39;type&#39;];</span><br><span class=\"line\">switch($type)&#123;</span><br><span class=\"line\">&#x2F;&#x2F;JSON返回</span><br><span class=\"line\">case &#39;json&#39;:</span><br><span class=\"line\">    header(&#39;Content-type:text&#x2F;json&#39;);</span><br><span class=\"line\">    die(json_encode([&#39;pic&#39;&#x3D;&gt;$pic]));</span><br><span class=\"line\">default:</span><br><span class=\"line\">    die(header(&quot;Location: $pic&quot;));</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">?&gt;</span><br></pre></td></tr></table></figure>\n<blockquote>\n<p>将两个文件上传到服务器的域名文件下即可</p>\n</blockquote>\n<h2 id=\"4-访问random-php域名\"><a href=\"#4-访问random-php域名\" class=\"headerlink\" title=\"4.访问random.php域名\"></a>4.访问random.php域名</h2><blockquote>\n<p>https://你的域名/(子文件夹)/random.php<br>文件夹和文件名称可以自定</p>\n</blockquote>\n","categories":[{"name":"技术·教程","path":"api/categories/技术·教程.json"}],"tags":[]}